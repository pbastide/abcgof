<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Posterior goodness of fit function — postgfit • abcgof</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior goodness of fit function — postgfit"><meta name="description" content="This function is likely to be DEPRECATED in stable versions of the package.
This function performs a prior Goodness of Fit (GoF) test,
that checks whether we can reject the hypothesis that the target
is from the same model as the particles from the sumstat matrix.
It works by sub-sampling nb.replicate points from a localized subset of the
reference table sumstat, and then by comparing the score of the
target with the distribution of scores of the calibration points."><meta property="og:description" content="This function is likely to be DEPRECATED in stable versions of the package.
This function performs a prior Goodness of Fit (GoF) test,
that checks whether we can reject the hypothesis that the target
is from the same model as the particles from the sumstat matrix.
It works by sub-sampling nb.replicate points from a localized subset of the
reference table sumstat, and then by comparing the score of the
target with the distribution of scores of the calibration points."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">abcgof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gaussian_laplace.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Posterior goodness of fit function</h1>

      <div class="d-none name"><code>postgfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is likely to be DEPRECATED in stable versions of the package.</p>
<p>This function performs a prior Goodness of Fit (GoF) test,
that checks whether we can reject the hypothesis that the <code>target</code>
is from the same model as the particles from the <code>sumstat</code> matrix.</p>
<p>It works by sub-sampling <code>nb.replicate</code> points from a localized subset of the
reference table <code>sumstat</code>, and then by comparing the score of the
<code>target</code> with the distribution of scores of the calibration points.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">postgfit</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">sumstat</span>,</span>
<span>  <span class="va">sumstat.replica</span>,</span>
<span>  nb.replicate <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lof"</span>, <span class="st">"kNN"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">14</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  k_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  norm <span class="op">=</span> <span class="va">sd</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>a matrix of observations, with dimension Nobs x Nstats.</p></dd>


<dt id="arg-sumstat">sumstat<a class="anchor" aria-label="anchor" href="#arg-sumstat"></a></dt>
<dd><p>a matrix of summary statistics from the training set,
with dimension Ntrain x Nstats.</p></dd>


<dt id="arg-sumstat-replica">sumstat.replica<a class="anchor" aria-label="anchor" href="#arg-sumstat-replica"></a></dt>
<dd><p>a matrix of replicate summary statistics from the training set,
with dimension Ntrain x Nstats.
Each line i of the replicate summary statistic should have been simulated
with the same parameters as the one used for the same line i of the reference table.</p></dd>


<dt id="arg-nb-replicate">nb.replicate<a class="anchor" aria-label="anchor" href="#arg-nb-replicate"></a></dt>
<dd><p>number of replicates to draw from the training set for the calibration of the p value.</p></dd>


<dt id="arg-score">score<a class="anchor" aria-label="anchor" href="#arg-score"></a></dt>
<dd><p>the score to use for calling outliers. Can be "lof", "kNN", or both.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The kth-distance to be used to calculate LOFs of kNNs.
k can be a vector which contains multiple k values based on which the score needs to be calculated.</p></dd>


<dt id="arg-k-range">k_range<a class="anchor" aria-label="anchor" href="#arg-k-range"></a></dt>
<dd><p>A vector of min and max values for k when using the "LOF max" score (see Details).</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>the proportion of data points used to approximate the posterior distribution
of the reference table around each observation point. Default to 0.01.</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>the normalization function. Default to <code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></code>.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>number of cores for parallel computations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For each score, it a list with:</p><ul><li><p><code>score.calib</code> a matrix of LOF scores for the calibration data (rows), for each possible value of k.</p></li>
<li><p><code>score.test</code> a matrix of LOF scores for the test data (rows), for each possible value of k.</p></li>
<li><p><code>pval</code> a matrix of p-values for the test data (rows), for each possible value of k.</p></li>
<li><p><code>n.ref</code> the number of particles in the reference dataset (number of rows of <code>sumstat</code>).</p></li>
<li><p><code>n.calib</code> the number of particles used for calibration (equal to <code>nb.replicate</code>).</p></li>
<li><p><code>k_range</code> the min and max values for k when using the "LOF max" score.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Le Mailloux G., Bastide, P., Marin, J-M., Estoup, A. (2024+),
Goodness of Fit for Bayesian Generative Models with Applications in Population Genetics.</p>
<p>Markus M. Breunig, Hans-Peter Kriegel, Raymond T. Ng, and Jörg Sander. 2000.
LOF: identifying density-based local outliers. SIGMOD Rec. 29, 2 (June 2000), 93–104.
https://doi.org/10.1145/335191.335388</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gfit.html">gfit()</a></code> for pre-inference prior GoF test.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Bastide, Arnaud Estoup, Guillaume Le Mailloux, Jean-Michel Marin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

